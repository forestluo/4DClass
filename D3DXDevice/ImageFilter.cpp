///////////////////////////////////////////////////////////////////////////////
//
// ImageFilter.cpp
// 
// 4DClass Developer
// Copyright (c) 4DClass. All rights reserved.
//
///////////////////////////////////////////////////////////////////////////////

#include "ImageFilter.h"

///////////////////////////////////////////////////////////////////////////////
//
// Including
//
///////////////////////////////////////////////////////////////////////////////

#include "ImageDevice.h"
#include "KinectDevice.h"

///////////////////////////////////////////////////////////////////////////////
//
// Global
//
///////////////////////////////////////////////////////////////////////////////

//Set base of object.
const C4DBase CImageFilter::base(L"CImageFilter",L"CD3DXFilter");

///////////////////////////////////////////////////////////////////////////////
//
// CImageFilter
//
// Default construction.
//
///////////////////////////////////////////////////////////////////////////////

CImageFilter::CImageFilter(void)
{

}

///////////////////////////////////////////////////////////////////////////////
//
// CImageFilter
//
// Default deconstruction.
//
///////////////////////////////////////////////////////////////////////////////

CImageFilter::~CImageFilter(void)
{

}

///////////////////////////////////////////////////////////////////////////////
//
// GetWidth
//
///////////////////////////////////////////////////////////////////////////////

_INTEGER CImageFilter::getWidth() const
{
	//Get device.
	CD3DXDevice* device = getDevice();
#ifdef _DEBUG
	assert(device != _NULL);
#endif
	//Check instance.
	if(IS_IMAGEDEVICE_BASE(device))
	{
		//Return result.
		return ((CImageDevice *)device)->getWidth();
	}
	else if(IS_KINECTDEVICE_BASE(device))
	{
		//Return result.
		return ((CKinectDevice *)device)->getWidth();
	}
#ifdef _DEBUG
	else assert(_FALSE);
#endif
	//Return -1.
	return -1;
}

///////////////////////////////////////////////////////////////////////////////
//
// GetHeight
//
///////////////////////////////////////////////////////////////////////////////

_INTEGER CImageFilter::getHeight() const
{
	//Get device.
	CD3DXDevice* device = getDevice();
#ifdef _DEBUG
	assert(device != _NULL);
#endif
	//Check instance.
	if(IS_IMAGEDEVICE_BASE(device))
	{
		//Return result.
		return ((CImageDevice *)device)->getHeight();
	}
	else if(IS_KINECTDEVICE_BASE(device))
	{
		//Return result.
		return ((CKinectDevice *)device)->getHeight();
	}
#ifdef _DEBUG
	else assert(_FALSE);
#endif
	//Return -1.
	return -1;
}

///////////////////////////////////////////////////////////////////////////////
//
// SelectDevice
//
///////////////////////////////////////////////////////////////////////////////

_BOOL CImageFilter::selectDevice(CResourceManager* resourceManager,const CNormalString& name)
{
	//Do select.
	if(CD3DXFilter::selectDevice(resourceManager,name))
	{
		//Get device.
		CD3DXDevice* device = getDevice();
#ifdef _DEBUG
		assert(device != _NULL);
#endif
		//Create image.
		return COpenCVImageAttribute::createImage(getWidth(),getHeight());
	}
	//Return false.
	return _FALSE;
}
