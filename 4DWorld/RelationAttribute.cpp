///////////////////////////////////////////////////////////////////////////////
//
// RelationAttribute.cpp
//  
// 4DClass Developer
// Copyright (c) 4DClass. All rights reserved.
//
///////////////////////////////////////////////////////////////////////////////

#include "RelationAttribute.h"

///////////////////////////////////////////////////////////////////////////////
//
// Including
//
///////////////////////////////////////////////////////////////////////////////

#include "WorldObject.h"

///////////////////////////////////////////////////////////////////////////////
//
// CRelationAttribute
//
// Default construction.
//
/////////////////////////////////////////////////////////////////////////////////

CRelationAttribute::CRelationAttribute(void)
{
	//Set default value.
	parentObject = _NULL;
	physicsObject = _NULL;
	renderableObject = _NULL;
}

///////////////////////////////////////////////////////////////////////////////
//
// CRelationAttribute
//
// Default deconstruction.
//
/////////////////////////////////////////////////////////////////////////////////

CRelationAttribute::~CRelationAttribute(void)
{
	//Clear value.
	parentObject = _NULL;
	physicsObject = _NULL;
	renderableObject = _NULL;
}

///////////////////////////////////////////////////////////////////////////////
//
// GetThis
//
///////////////////////////////////////////////////////////////////////////////

_OBJECT CRelationAttribute::getThis() const
{
	//Return result.
	return thisObject;
}

///////////////////////////////////////////////////////////////////////////////
//
// SetThis
//
///////////////////////////////////////////////////////////////////////////////
	
void CRelationAttribute::setThis(_OBJECT thisObject)
{
#ifdef _DEBUG
	assert(thisObject != _NULL);
#endif
	//Set this object.
	this->thisObject = thisObject;
}

///////////////////////////////////////////////////////////////////////////////
//
// GetParent
//
///////////////////////////////////////////////////////////////////////////////

_OBJECT CRelationAttribute::getParent() const
{
	//Return result.
	return parentObject;
}

///////////////////////////////////////////////////////////////////////////////
//
// SetParent
//
///////////////////////////////////////////////////////////////////////////////
	
void CRelationAttribute::setParent(_OBJECT parentObject)
{
#ifdef _DEBUG
	assert(parentObject != _NULL);
#endif
	//Set parent object.
	this->parentObject = parentObject;
}

///////////////////////////////////////////////////////////////////////////////
//
// IsPhysicsObject
//
///////////////////////////////////////////////////////////////////////////////

_BOOL CRelationAttribute::isPhysicsObject() const
{
	//Return result.
	return physicsObject != _NULL;
}

///////////////////////////////////////////////////////////////////////////////
//
// IsRenderableObject
//
///////////////////////////////////////////////////////////////////////////////

_BOOL CRelationAttribute::isRenderableObject() const
{
	//Return result.
	return renderableObject != _NULL;
}

///////////////////////////////////////////////////////////////////////////////
//
// IsRenderablePhysicsObject
//
///////////////////////////////////////////////////////////////////////////////

_BOOL CRelationAttribute::isRenderablePhysicsObject() const
{
	//Return result.
	return physicsObject != _NULL && renderableObject != _NULL;
}

///////////////////////////////////////////////////////////////////////////////
//
// GetPhysics
//
///////////////////////////////////////////////////////////////////////////////

_OBJECT CRelationAttribute::getPhysics() const
{
	//Return result.
	return physicsObject;
}

///////////////////////////////////////////////////////////////////////////////
//
// SetPhysics
//
///////////////////////////////////////////////////////////////////////////////
	
void CRelationAttribute::setPhysics(_OBJECT physicsObject)
{
#ifdef _DEBUG
	assert(physicsObject != _NULL);
#endif
	//Set physics object.
	this->physicsObject = physicsObject;
}

///////////////////////////////////////////////////////////////////////////////
//
// GetRenderable
//
///////////////////////////////////////////////////////////////////////////////

_OBJECT CRelationAttribute::getRenderable() const
{
	//Return result.
	return renderableObject;
}

///////////////////////////////////////////////////////////////////////////////
//
// SetRenderable
//
///////////////////////////////////////////////////////////////////////////////
	
void CRelationAttribute::setRenderable(_OBJECT renderableObject)
{
#ifdef _DEBUG
	assert(renderableObject != _NULL);
#endif
	//Set renderable object.
	this->renderableObject = renderableObject;
}

///////////////////////////////////////////////////////////////////////////////
//
// GetTopParent
//
///////////////////////////////////////////////////////////////////////////////

_OBJECT CRelationAttribute::getTopParent(_OBJECT object)
{
#ifdef _DEBUG
	assert(object != _NULL);
#endif

	//Last parent.
	CWorldObject* last = (CWorldObject *)object;
	//Get parent.
	CWorldObject* parent = (CWorldObject *)((CWorldObject *)object)->getParent();

	//Max depth.
	_INTEGER maxDepth = 0;
	//Do while.
	do
	{
		//Check result.
		if(parent == _NULL) return last;
		//Set last.
		last = parent;
		//Do while.
		parent = (CWorldObject *)parent->getParent();

		//Sub depth.
		maxDepth ++;
#ifdef _DEBUG
		assert(maxDepth < 16);
#endif

	}while(maxDepth < 256);
	//Return null.
	return (CWorldObject *)_NULL;
}
