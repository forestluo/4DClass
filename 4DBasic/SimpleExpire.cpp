///////////////////////////////////////////////////////////////////////////////
//
// SimpleExpire.h
//  
// 4DClass Developer
// Copyright (c) 4DClass. All rights reserved.
//
///////////////////////////////////////////////////////////////////////////////

#include "SimpleExpire.h"

///////////////////////////////////////////////////////////////////////////////
//
// CSimpleExpire
//
///////////////////////////////////////////////////////////////////////////////

CSimpleExpire::CSimpleExpire(void)
{
	//Set default value.
	expiration = NEVER_EXPIRE;
}

///////////////////////////////////////////////////////////////////////////////
//
// CSimpleExpire
//
///////////////////////////////////////////////////////////////////////////////

CSimpleExpire::CSimpleExpire(_LONG expiration)
{
	//Set value.
	this->expiration = expiration;
}

///////////////////////////////////////////////////////////////////////////////
//
// ~CSimpleExpire
//
///////////////////////////////////////////////////////////////////////////////

CSimpleExpire::~CSimpleExpire(void)
{

}

///////////////////////////////////////////////////////////////////////////////
//
// IsExpired
//
///////////////////////////////////////////////////////////////////////////////
	
_BOOL CSimpleExpire::isExpired()
{
	//Value.
	_BOOL value;
	//Open.
	openLock();
	{
		//Check expiration.
		if(expiration == NEVER_EXPIRE)
		{
			//Set value.
			value = _FALSE;
		}
		else
		{
			//Set value.
			value = (getTimestamp() + expiration) < getMilliseconds();
		}
	}
	//Close.
	closeLock();
	//Return value.
	return value;
}

///////////////////////////////////////////////////////////////////////////////
//
// IsExpired
//
///////////////////////////////////////////////////////////////////////////////
	
_BOOL CSimpleExpire::isExpired(_LONG expiration)
{
	//Value.
	_BOOL value;
	//Open.
	openLock();
	{
		//Check expiration.
		if(expiration == NEVER_EXPIRE)
		{
			//Set value.
			value = _FALSE;
		}
		else
		{
			//Set value.
			value = (getTimestamp() + expiration) < getMilliseconds();
		}
	}
	//Close.
	closeLock();
	//Return value.
	return value;
}

///////////////////////////////////////////////////////////////////////////////
//
// GetExpiration
//
///////////////////////////////////////////////////////////////////////////////

_LONG CSimpleExpire::getExpiration()
{
	//Value.
	_LONG expiration;
	//Open.
	openLock();
	{
		//Set value.
		expiration = this->expiration;
	}
	//Close.
	closeLock();
	//Return result.
	return expiration;
}

///////////////////////////////////////////////////////////////////////////////
//
// SetExpiration
//
///////////////////////////////////////////////////////////////////////////////

void CSimpleExpire::setExpiration(_LONG expiration)
{
	//Open.
	openLock();
	{
		//Set value.
		this->expiration = expiration;
	}
	//Close.
	closeLock();
}
